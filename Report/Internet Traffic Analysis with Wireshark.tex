\documentclass[a4paper,11pt]{article}
\usepackage{setspace}
\onehalfspacing
  
\usepackage{caption}
\usepackage{titlesec}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{fancyhdr}
\usepackage[a4paper,margin=1in]{geometry}
\usepackage{mdframed} %nice frames

\definecolor{light-gray}{gray}{0.95} %the shade of grey that stack exchange uses

\renewcommand{\thispagestyle}[1]{} % do nothing

\lstset{
  language=Python,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=true,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{red},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=2
}

\graphicspath{ {./images/} }
\titlespacing{\section}{0pc}{1pc}{1pc}
 
\pagestyle{fancy}
\fancyhf{}
\rhead{Assignment 6}
\lhead{Programming using libpcap}
\rfoot{Page \thepage}

 
\begin{document}
\title{\vspace{-1.0cm}\textbf{Programming using libpcapk}}
\author{
  \textbf{Tan Wei Xuan (49003140)}\\
  \texttt{tanweixuan@postech.ac.kr}
}
\date{\today}
\maketitle

\section{Capturing Packets using libpcap}
The file \textbf{"question1.c"} contains the source code required to capture \textbf{TCP, UDP and ICMP traffic} on my Network Interface Card for a period of 40 seconds. The key functions that I have utilised to capture these traffic are as follow:
\begin{enumerate}
\item \textbf{pcap\_lookupdev()}
\item \textbf{pcap\_openlive()}
\item \textbf{pcap\_compile() and pcap\_setfilter()}
\item \textbf{pcap\_dump\_open()}
\end{enumerate}

\subsection{Total Number of Packets and Bytes}
\begin{figure}[h!]
	\includegraphics{TtlNoPacketsBytes}
	\caption{\textit{Capture Statistics (Statistics $\rightarrow$ Capture File Properties)}}
\end{figure}
The total number of packets being captured between a \textbf{59 second period} is \textbf{4137680}. The total number of Bytes between captured is \textbf{3120951509}. This information can be obtained thorugh \textit{Stastics $\rightarrow$ Capture File Properties}.

\subsection{Time Difference between First and Last Packet }
\includegraphics{TimeDiff}
\newline
\newline
We know that the total number of packets being captured is \textbf{4137680}. As such, the first frame be captured will be \textbf{1} and the last frame being captured will be \textbf{4137680}. We can filter out these two frames by applying the filter, \textit{\textbf{(frame.number $==$ 1) $||$ (frame.number $==$ 4137680)}}. From the filtered results, we can see that the first packet is being transmitted at \textbf{0.0} seconds while the last packet is being transmitted at \textbf{59.087530} seconds. As such, the \textbf{time difference} between the \textbf{first} and \textbf{last} packet is \textbf{59.087530 seconds}

\subsection{The number of packet and total bytes of TCP, UDP and ICMP traffic }
\begin{figure}[h!]
	\includegraphics[width = 16cm]{Traffic}
	\caption{\textit{TCP,UDP and ICMP Proticol Hierarchy (Statistics $\rightarrow$ Protocol Hierarchy)}}
\end{figure}
The entirety of the network traffic is being transmitted through \textbf{IPv4} as it takes up \textbf{100\%} of the total packets.
The total number of packet and total bytes of IPv4 TCP, UDP and Internel Control Message Protocol (ICMP) traffic are as follow:
\begin{enumerate}
	\item \textbf{TCP}
	\newline
	The total number of packets being transmitted using TCP is \textbf{1568769} and  the total number of bytes being transmitted is \textbf{43878139}.
	TCP takes up \textbf{37.9\%} of total network traffic.
	\item \textbf{UDP}
	\newline
	The total number of packets being transmitted using UDP is \textbf{2533291} and  the total number of bytes being transmitted is \textbf{20266328}. 	
	UDP takes up \textbf{61.2\%} of total network traffic.
	\item \textbf{ICMP}
	\newline
	The total number of packets being transmitted using ICMP is \textbf{31256} and  the total number of bytes being transmitted is \textbf{978571}. 	
	ICMP takes up \textbf{0.8\%} of total network traffic.
\end{enumerate}
For this captured netwrok traffic, IPv4 TCP and UDP take the majority of the percent of total packets, with \textbf{UDP taking up most of the traffic \textit{(61\%)}}. Most of the traffic is probably allocated for UDP services such as Media Streaming, VoIP, etc.
This information can be obtained thorugh \textit{Statistics $\rightarrow$ Protocol Hierarchy}.

\section{Packet Analysis using libpcap}

\section{Packet Decapsulation using libpcap}

\end{document}